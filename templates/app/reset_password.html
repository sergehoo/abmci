<!-- templates/app/reset_password.html -->
<!doctype html><meta charset="utf-8">
<title>Ouverture de l’app…</title>
<p>Ouverture de l’app… Si rien ne se passe, <a id="fallback" href="#">cliquez ici</a>.</p>
<script>
  const p = new URLSearchParams(location.search);
  const uid = p.get('uid'); const token = p.get('token');

  // Schéma custom (Android/iOS)
  const appUrl = `allianceconnect://reset-password?uid=${encodeURIComponent(uid||'')}&token=${encodeURIComponent(token||'')}`;

  // URL web fallback (A ci-dessus)
  const webUrl = `/app/reset-password?uid=${encodeURIComponent(uid||'')}&token=${encodeURIComponent(token||'')}`;

  // Tente d’ouvrir l’app
  location.href = appUrl;

  // Fallback après 1.2s si l’app n’a pas intercepté
  setTimeout(() => { location.href = webUrl; }, 1200);

  document.getElementById('fallback').href = webUrl;
</script>
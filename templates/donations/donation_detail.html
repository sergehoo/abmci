{% extends 'layout/base.html' %}

{% block title %}Détails du Don - {{ donation.reference }}{% endblock %}

{% block content %}
<div class="max-w-4xl mx-auto">
    <div class="bg-white rounded-xl shadow-sm overflow-hidden">
        <!-- Header -->
        <div class="bg-gradient-to-r from-primary to-purple-600 text-white p-6">
            <div class="flex items-center justify-between">
                <div>
                    <h1 class="text-2xl font-bold">Détails du Don</h1>
                    <p class="opacity-90">Référence: {{ donation.reference }}</p>
                </div>
                <div class="text-right">
                    {% if donation.status == 'success' %}
                    <span class="px-3 py-1 bg-green-500 text-white rounded-full text-sm font-medium">
                        <i class="fas fa-check-circle mr-1"></i>Réussi
                    </span>
                    {% elif donation.status == 'pending' %}
                    <span class="px-3 py-1 bg-yellow-500 text-white rounded-full text-sm font-medium">
                        <i class="fas fa-clock mr-1"></i>En attente
                    </span>
                    {% elif donation.status == 'failed' %}
                    <span class="px-3 py-1 bg-red-500 text-white rounded-full text-sm font-medium">
                        <i class="fas fa-times-circle mr-1"></i>Échoué
                    </span>
                    {% endif %}
                </div>
            </div>
        </div>

        <!-- Content -->
        <div class="p-6">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                <div class="bg-gray-50 rounded-lg p-4">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">Informations du Don</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between">
                            <span class="text-gray-600">Catégorie:</span>
                            <span class="font-medium">{{ donation.category.name }}</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-600">Montant:</span>
                            <span class="font-medium text-primary">{{ donation.amount }} {{ donation.currency }}</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-600">Récurrence:</span>
                            <span class="font-medium">{{ donation.get_recurrence_display }}</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-600">Méthode de paiement:</span>
                            <span class="font-medium">{{ donation.get_payment_method_display }}</span>
                        </div>
                    </div>
                </div>

                <div class="bg-gray-50 rounded-lg p-4">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">Dates</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between">
                            <span class="text-gray-600">Créé le:</span>
                            <span class="font-medium">{{ donation.created_at|date:"d/m/Y H:i" }}</span>
                        </div>
                        {% if donation.paid_at %}
                        <div class="flex justify-between">
                            <span class="text-gray-600">Payé le:</span>
                            <span class="font-medium">{{ donation.paid_at|date:"d/m/Y H:i" }}</span>
                        </div>
                        {% endif %}
                    </div>
                </div>
            </div>

            <!-- Actions -->
            <div class="border-t border-gray-200 pt-6">
                <div class="flex flex-wrap gap-4">
                    {% if donation.status == 'pending' %}
                    <a href="{{ donation.authorization_url }}" 
                       class="bg-secondary text-white px-6 py-2 rounded-lg hover:bg-secondary-dark transition">
                        <i class="fas fa-external-link-alt mr-2"></i>Compléter le paiement
                    </a>
                    {% endif %}
                    
                    <a href="{% url 'donation-list' %}" 
                       class="bg-gray-300 text-gray-700 px-6 py-2 rounded-lg hover:bg-gray-400 transition">
                        <i class="fas fa-arrow-left mr-2"></i>Retour à la liste
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- Informations supplémentaires -->
    {% if donation.meta %}
    <div class="bg-white rounded-xl shadow-sm p-6 mt-6">
        <h3 class="text-lg font-semibold text-gray-900 mb-4">Informations supplémentaires</h3>
        <pre class="bg-gray-50 p-4 rounded-lg overflow-x-auto text-sm">{{ donation.meta|pprint }}</pre>
    </div>
    {% endif %}
</div>
{% endblock %}